!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>RENARD - Panel Administrativo</title>
  
  <!-- CSS de Bootstrap 5 -->
  <link href="https://cdnjs.cloudflare.com/ajax/libs/bootstrap/5.3.0/css/bootstrap.min.css" rel="stylesheet">
  
  <!-- Íconos de Bootstrap -->
  <link href="https://cdnjs.cloudflare.com/ajax/libs/bootstrap-icons/1.10.5/font/bootstrap-icons.min.css" rel="stylesheet">
  
  <!-- Tipografía moderna (Google Fonts) -->
  <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;500;600&display=swap" rel="stylesheet">
  
  <style>
    /* Variables de colores */
    :root {
      --primary: #FF5A00;      /* Color principal similar a Rappi */
      --secondary: #FF8C38;    /* Color secundario */
      --dark: #333333;         /* Texto oscuro */
      --light: #F8F9FA;        /* Fondos claros */
      --gray-light: #E9ECEF;   /* Gris claro para bordes */
    }
    
    /* Estilos generales */
    body {
      font-family: 'Poppins', sans-serif;
      color: var(--dark);
      background-color: #FCFCFC;
      display: flex;
      min-height: 100vh;
    }
    
    /* Sidebar */
    .sidebar {
      width: 280px;
      background-color: white;
      border-right: 1px solid var(--gray-light);
      min-height: 100vh;
      position: fixed;
      box-shadow: 2px 0 5px rgba(0,0,0,0.05);
    }
    
    .sidebar-header {
      padding: 1.5rem;
      border-bottom: 1px solid var(--gray-light);
    }
    
    .sidebar-brand {
      font-weight: 600;
      font-size: 1.5rem;
      color: var(--primary);
      text-decoration: none;
    }
    
    .sidebar-menu {
      padding: 1rem 0;
    }
    
    .sidebar-menu-item {
      padding: 0.75rem 1.5rem;
      display: flex;
      align-items: center;
      color: var(--dark);
      text-decoration: none;
      transition: all 0.3s;
    }
    
    .sidebar-menu-item:hover,
    .sidebar-menu-item.active {
      background-color: rgba(255, 90, 0, 0.1);
      color: var(--primary);
    }
    
    .sidebar-menu-item i {
      margin-right: 0.75rem;
      font-size: 1.1rem;
    }
    
    /* Contenido principal */
    .main-content {
      flex: 1;
      margin-left: 280px;
      padding: 2rem;
    }
    
    .page-title {
      font-weight: 600;
      margin-bottom: 1.5rem;
      padding-bottom: 1rem;
      border-bottom: 1px solid var(--gray-light);
    }
    
    /* Tarjetas de productos */
    .product-card {
      border-radius: 12px;
      border: 1px solid var(--gray-light);
      transition: all 0.3s;
      height: 100%;
      display: flex;
      flex-direction: column;
      overflow: hidden;
    }
    
    .product-card:hover {
      box-shadow: 0 5px 15px rgba(0, 0, 0, 0.1);
      transform: translateY(-5px);
    }
    
    .product-card .card-img-container {
      height: 180px;
      overflow: hidden;
    }
    
    .product-card img {
      width: 100%;
      height: 100%;
      object-fit: cover;
      transition: transform 0.3s;
    }
    
    .product-card:hover img {
      transform: scale(1.05);
    }
    
    .product-card .card-body {
      flex: 1;
      display: flex;
      flex-direction: column;
    }
    
    .product-actions {
      display: flex;
      gap: 0.5rem;
      margin-top: auto;
    }
    
    .btn-primary {
      background-color: var(--primary);
      border-color: var(--primary);
    }
    
    .btn-primary:hover {
      background-color: var(--secondary);
      border-color: var(--secondary);
    }
    
    /* Formulario */
    .form-container {
      background-color: white;
      border-radius: 12px;
      padding: 2rem;
      box-shadow: 0 5px 15px rgba(0, 0, 0, 0.05);
    }
    
    .preview-image {
      width: 100%;
      height: 200px;
      object-fit: cover;
      border-radius: 8px;
      margin-bottom: 1rem;
    }
    
    /* Login */
    .login-container {
      display: flex;
      justify-content: center;
      align-items: center;
      min-height: 100vh;
      background-color: #f8f9fa;
    }
    
    .login-card {
      width: 400px;
      padding: 2rem;
      background-color: white;
      border-radius: 12px;
      box-shadow: 0 5px 15px rgba(0, 0, 0, 0.1);
    }
    
    .login-logo {
      color: var(--primary);
      font-size: 2rem;
      font-weight: 600;
      text-align: center;
      margin-bottom: 2rem;
    }
  </style>
</head>
<body>
  <!-- Login (este div aparecerá si no hay sesión iniciada) -->
  <div class="login-container" id="login-section">
    <div class="login-card">
      <div class="login-logo">RENARD</div>
      <h4 class="text-center mb-4">Panel Administrativo</h4>
      <form id="login-form">
        <div class="mb-3">
          <label for="username" class="form-label">Usuario</label>
          <input type="text" class="form-control" id="username" required>
        </div>
        <div class="mb-3">
          <label for="password" class="form-label">Contraseña</label>
          <input type="password" class="form-control" id="password" required>
        </div>
        <button type="submit" class="btn btn-primary w-100">Iniciar sesión</button>
      </form>
      <p class="text-danger mt-3" id="login-error" style="display: none;">Usuario o contraseña incorrecta</p>
    </div>
  </div>
  
  <!-- Dashboard (este div aparecerá después de iniciar sesión) -->
  <div id="dashboard-section" style="display: none; width: 100%;">
    <!-- Sidebar -->
    <div class="sidebar">
      <div class="sidebar-header">
        <a href="#" class="sidebar-brand">RENARD</a>
        <div class="text-muted mt-2">Panel Administrativo</div>
      </div>
      <div class="sidebar-menu">
        <a href="#" class="sidebar-menu-item active" onclick="showProductsSection()">
          <i class="bi bi-grid"></i> Productos
        </a>
        <a href="#" class="sidebar-menu-item" onclick="showCategoriesSection()">
          <i class="bi bi-tags"></i> Categorías
        </a>
        <a href="#" class="sidebar-menu-item" onclick="showPromotionsSection()">
          <i class="bi bi-megaphone"></i> Promociones
        </a>
        <a href="#" class="sidebar-menu-item" onclick="showSettingsSection()">
          <i class="bi bi-gear"></i> Configuración
        </a>
        <a href="#" class="sidebar-menu-item text-danger" onclick="logout()">
          <i class="bi bi-box-arrow-left"></i> Cerrar sesión
        </a>
      </div>
    </div>
    
    <!-- Contenido principal -->
    <div class="main-content">
      <!-- Sección de Productos -->
      <div id="products-section">
        <div class="d-flex justify-content-between align-items-center">
          <h2 class="page-title">Gestión de Productos</h2>
          <button class="btn btn-primary" onclick="showAddProductForm()">
            <i class="bi bi-plus-circle"></i> Añadir Producto
          </button>
        </div>
        
        <!-- Filtros -->
        <div class="row mb-4">
          <div class="col-md-6">
            <div class="input-group">
              <input type="text" class="form-control" placeholder="Buscar productos..." id="search-product">
              <button class="btn btn-outline-secondary" type="button">
                <i class="bi bi-search"></i>
              </button>
            </div>
          </div>
          <div class="col-md-6">
            <div class="d-flex justify-content-end">
              <select class="form-select w-50" id="filter-category">
                <option value="">Todas las categorías</option>
                <option value="hamburguesas">Hamburguesas</option>
                <option value="acompanamientos">Acompañamientos</option>
                <option value="bebidas">Bebidas</option>
                <option value="postres">Postres</option>
                <option value="promociones">Promociones</option>
              </select>
            </div>
          </div>
        </div>
        
        <!-- Lista de productos -->
        <div class="row row-cols-1 row-cols-md-2 row-cols-lg-3 g-4" id="products-list">
          <!-- Los productos se cargarán dinámicamente aquí -->
        </div>
      </div>
      
      <!-- Formulario para añadir/editar un producto -->
      <div id="product-form-section" style="display: none;">
        <div class="d-flex justify-content-between align-items-center">
          <h2 class="page-title" id="form-title">Añadir Nuevo Producto</h2>
          <button class="btn btn-outline-secondary" onclick="showProductsSection()">
            <i class="bi bi-arrow-left"></i> Volver
          </button>
        </div>
        
        <div class="form-container">
          <form id="product-form">
            <input type="hidden" id="product-id">
            
            <div class="row mb-4">
              <div class="col-md-4">
                <img src="https://via.placeholder.com/300x200" class="preview-image" id="image-preview" alt="Vista previa">
                <div class="mb-3">
                  <label for="product-image" class="form-label">Imagen del producto</label>
                  <input type="file" class="form-control" id="product-image" accept="image/*" onchange="previewImage(event)">
                </div>
                <div class="mb-3">
                  <label for="product-image-url" class="form-label">O URL de la imagen</label>
                  <input type="text" class="form-control" id="product-image-url" placeholder="https://ejemplo.com/imagen.jpg" onchange="previewImageUrl()">
                </div>
              </div>
              
              <div class="col-md-8">
                <div class="mb-3">
                  <label for="product-name" class="form-label">Nombre del producto</label>
                  <input type="text" class="form-control" id="product-name" required>
                </div>
                
                <div class="mb-3">
                  <label for="product-description" class="form-label">Descripción</label>
                  <textarea class="form-control" id="product-description" rows="3" required></textarea>
                </div>
                
                <div class="row">
                  <div class="col-md-6 mb-3">
                    <label for="product-price" class="form-label">Precio (COP)</label>
                    <input type="number" class="form-control" id="product-price" min="0" step="100" required>
                  </div>
                  
                  <div class="col-md-6 mb-3">
                    <label for="product-category" class="form-label">Categoría</label>
                    <select class="form-select" id="product-category" required>
                      <option value="">Seleccionar categoría</option>
                      <option value="hamburguesas">Hamburguesas</option>
                      <option value="acompanamientos">Acompañamientos</option>
                      <option value="bebidas">Bebidas</option>
                      <option value="postres">Postres</option>
                      <option value="promociones">Promociones</option>
                    </select>
                  </div>
                </div>
                
                <div class="form-check mb-3">
                  <input class="form-check-input" type="checkbox" value="" id="product-available" checked>
                  <label class="form-check-label" for="product-available">
                    Disponible para la venta
                  </label>
                </div>
              </div>
            </div>
            
            <div class="d-flex justify-content-end gap-2">
              <button type="button" class="btn btn-outline-secondary" onclick="showProductsSection()">Cancelar</button>
              <button type="submit" class="btn btn-primary">Guardar Producto</button>
            </div>
          </form>
        </div>
      </div>
      
      <!-- Sección de Categorías (vacío por ahora, se puede implementar en el futuro) -->
      <div id="categories-section" style="display: none;">
        <h2 class="page-title">Gestión de Categorías</h2>
        <p>Esta sección está en desarrollo.</p>
      </div>
      
      <!-- Sección de Promociones (vacío por ahora, se puede implementar en el futuro) -->
      <div id="promotions-section" style="display: none;">
        <h2 class="page-title">Gestión de Promociones</h2>
        <p>Esta sección está en desarrollo.</p>
      </div>
      
      <!-- Sección de Configuración (vacío por ahora, se puede implementar en el futuro) -->
      <div id="settings-section" style="display: none;">
        <h2 class="page-title">Configuración del Sitio</h2>
        <p>Esta sección está en desarrollo.</p>
      </div>
    </div>
  </div>
  
  <!-- Modal de confirmación para eliminar -->
  <div class="modal fade" id="deleteModal" tabindex="-1" aria-labelledby="deleteModalLabel" aria-hidden="true">
    <div class="modal-dialog">
      <div class="modal-content">
        <div class="modal-header">
          <h5 class="modal-title" id="deleteModalLabel">Confirmar eliminación</h5>
          <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
        </div>
        <div class="modal-body">
          ¿Estás seguro de que quieres eliminar el producto <span id="delete-product-name" class="fw-bold"></span>?
          Esta acción no se puede deshacer.
        </div>
        <div class="modal-footer">
          <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancelar</button>
          <button type="button" class="btn btn-danger" id="confirm-delete">Eliminar</button>
        </div>
      </div>
    </div>
  </div>
  
  <!-- Scripts -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/bootstrap/5.3.0/js/bootstrap.bundle.min.js"></script>
  
  <script>
    // Definimos variables globales
    let productsData = [];
    let currentProductId = null;
    let deleteModal;
    
    // Simulación de base de datos con localStorage
    function initDatabase() {
      // Si no existe la base de datos de productos, la creamos con datos de ejemplo
      if (!localStorage.getItem('renard_products')) {
        const initialProducts = [
          {
            id: 1,
            name: "Hamburguesa Clásica",
            description: "Carne de res, queso cheddar, lechuga, tomate y aderezo especial.",
            price: 30000,
            category: "hamburguesas",
            imageUrl: "RENARD/Imagenes/sencilla2.jpg",
            available: true
          },
          {
            id: 2,
            name: "Hamburguesa BBQ",
            description: "Carne de res, tocino, cebolla caramelizada, queso y salsa BBQ.",
            price: 35000,
            category: "hamburguesas",
            imageUrl: "RENARD/Imagenes/bbq.jpg",
            available: true
          },
          {
            id: 3,
            name: "Papas fritas",
            description: "Crujientes papas fritas con sal.",
            price: 10000,
            category: "acompanamientos",
            imageUrl: "RENARD/Imagenes/papas.jpg",
            available: true
          }
        ];
        
        localStorage.setItem('renard_products', JSON.stringify(initialProducts));
      }
      
      // Configurar credenciales de admin (esto es solo para demostración, 
      // en producción debería ser manejado por un backend)
      if (!localStorage.getItem('renard_admin')) {
        const admin = {
          username: "admin",
          password: "admin123"
        };
        localStorage.setItem('renard_admin', JSON.stringify(admin));
      }
    }
    
    // Cargar productos desde la "base de datos"
    function loadProducts() {
      productsData = JSON.parse(localStorage.getItem('renard_products') || '[]');
      renderProducts();
    }
    
    // Renderizar la lista de productos
    function renderProducts() {
      const productsList = document.getElementById('products-list');
      const categoryFilter = document.getElementById('filter-category').value;
      const searchTerm = document.getElementById('search-product').value.toLowerCase();
      
      // Filtrar productos según los criterios
      let filteredProducts = productsData;
      
      if (categoryFilter) {
        filteredProducts = filteredProducts.filter(product => product.category === categoryFilter);
      }
      
      if (searchTerm) {
        filteredProducts = filteredProducts.filter(product => 
          product.name.toLowerCase().includes(searchTerm) || 
          product.description.toLowerCase().includes(searchTerm)
        );
      }
      
      // Generar HTML
      let productsHTML = '';
      
      if (filteredProducts.length === 0) {
        productsList.innerHTML = '<div class="col-12"><p class="text-center">No se encontraron productos.</p></div>';
        return;
      }
      
      filteredProducts.forEach(product => {
        productsHTML += `
          <div class="col">
            <div class="product-card">
              <div class="card-img-container">
                <img src="${product.imageUrl}" alt="${product.name}">
              </div>
              <div class="card-body p-3">
                <div class="d-flex justify-content-between align-items-start mb-2">
                  <h5 class="card-title mb-0">${product.name}</h5>
                  <span class="badge ${product.available ? 'bg-success' : 'bg-danger'}">
                    ${product.available ? 'Disponible' : 'No disponible'}
                  </span>
                </div>
                <p class="card-text text-muted mb-2">${product.description}</p>
                <div class="d-flex justify-content-between align-items-center mt-2">
                  <span class="fw-bold">$${product.price.toLocaleString()}</span>
                  <span class="badge bg-light text-dark">${getCategoryName(product.category)}</span>
                </div>
                <div class="product-actions mt-3">
                  <button class="btn btn-outline-primary flex-grow-1" onclick="editProduct(${product.id})">
                    <i class="bi bi-pencil"></i> Editar
                  </button>
                  <button class="btn btn-outline-danger flex-grow-1" onclick="showDeleteModal(${product.id})">
                    <i class="bi bi-trash"></i> Eliminar
                  </button>
                </div>
              </div>
            </div>
          </div>
        `;
      });
      
      productsList.innerHTML = productsHTML;
    }
    
    // Traducir ID de categoría a nombre legible
    function getCategoryName(categoryId) {
      const categories = {
        'hamburguesas': 'Hamburguesas',
        'acompanamientos': 'Acompañamientos',
        'bebidas': 'Bebidas',
        'postres': 'Postres',
        'promociones': 'Promociones'
      };
      
      return categories[categoryId] || categoryId;
    }
    
    // Función para mostrar el formulario de añadir producto
    function showAddProductForm() {
      // Resetear el formulario
      document.getElementById('product-form').reset();
      document.getElementById('product-id').value = '';
      document.getElementById('image-preview').src = 'https://via.placeholder.com/300x200';
      document.getElementById('form-title').textContent = 'Añadir Nuevo Producto';
      currentProductId = null;
      
      // Mostrar el formulario y ocultar la lista de productos
      document.getElementById('products-section').style.display = 'none';
      document.getElementById('product-form-section').style.display = 'block';
    }
    
    // Función para editar un producto existente
    function editProduct(productId) {
      const product = productsData.find(p => p.id === productId);
      if (!product) return;
      
      currentProductId = productId;
      
      // Rellenar el formulario con los datos del producto
      document.getElementById('product-id').value = product.id;
      document.getElementById('product-name').value = product.name;
      document.getElementById('product-description').value = product.description;
      document.getElementById('product-price').value = product.price;
      document.getElementById('product-category').value = product.category;
      document.getElementById('product-available').checked = product.available;
      document.getElementById('product-image-url').value = product.imageUrl;
      document.getElementById('image-preview').src = product.imageUrl;
      
      // Actualizar título del formulario
      document.getElementById('form-title').textContent = 'Editar Producto';
      
      // Mostrar el formulario y ocultar la lista de productos
      document.getElementById('products-section').style.display = 'none';
      document.getElementById('product-form-section').style.display = 'block';
    }
    
    // Previsualizar imagen seleccionada
    function previewImage(event) {
      const file = event.target.files[0];
      if (file) {
        const reader = new FileReader();
        reader.onload = function(e) {
          document.getElementById('image-preview').src = e.target.result;
          document.getElementById('product-image-url').value = ''; // Limpiar URL si se carga un archivo
        }
        reader.readAsDataURL(file);
      }
    }
    
    // Previsualizar imagen desde URL
    function previewImageUrl() {
      const url = document.getElementById('product-image-url').value;
      if (url) {
        document.getElementById('image-preview').src = url;
        document.getElementById('product-image').value = ''; // Limpiar archivo si se usa URL
      }
    }
    
    // Mostrar modal de confirmación para eliminar
    function showDeleteModal(productId) {
      const product = productsData.find(p => p.id === productId);
      if (!product) return;
      
      document.getElementById('delete-product-name').textContent = product.name;
      
      // Configurar evento de confirmar eliminación
      document.getElementById('confirm-delete').onclick = function() {
        deleteProduct(productId);
        deleteModal.hide();
      };
      
      // Mostrar el modal
      deleteModal.show();
    }
    
    // Eliminar un producto
    function deleteProduct(productId) {
      productsData = productsData.filter(p => p.id !== productId);
      saveProducts();
      renderProducts();
    }
    
    // Guardar los productos en el localStorage
    function saveProducts() {
      localStorage.setItem('renard_products', JSON.stringify(productsData));
    }
    
    // Funciones para mostrar/ocultar secciones
    function showProductsSection() {
      document.getElementById('products-section').style.display = 'block';
      document.getElementById('product-form-section').style.display = 'none';
      document.getElementById('categories-section').style.display = 'none';
      document.getElementById('promotions-section').style.display = 'none';
      document.getElementById('settings-section').style.display = 'none';
      
      // Actualizar menú activo
      setActiveMenuItem(0);
      
      // Recargar productos
      loadProducts();
    }
    
    function showCategoriesSection() {
      document.getElementById('products-section').style.display = 'none';
      document.getElementById('product-form-section').style.display = 'none';
      document.getElementById('categories-section').style.display = 'block';
      document.getElementById('promotions-section').style.display = 'none';
      document.getElementById('settings-section').style.display = 'none';
      
      // Actualizar menú activo
      setActiveMenuItem(1);
    }
    
    function showPromotionsSection() {
      document.getElementById('products-section').style.display = 'none';
      document.getElementById('product-form-section').style.display = 'none';
      document.getElementById('categories-section').style.display = 'none';
      document.getElementById('promotions-section').style.display = 'block';
      document.getElementById('settings-section').style.display = 'none';
      
      // Actualizar menú activo
      setActiveMenuItem(2);
    }
    
    function showSettingsSection() {
      document.getElementById('products-section').style.display = 'none';
      document.getElementById('product-form-section').style.display = 'none';
      document.getElementById('categories-section').style.display = 'none';
      document.getElementById('promotions-section').style.display = 'none';
      document.getElementById('settings-section').style.display = 'block';
      
      // Actualizar menú activo
      setActiveMenuItem(3);
    }
    
    function setActiveMenuItem(index) {
      const menuItems = document.querySelectorAll('.sidebar-menu-item');
      menuItems.forEach((item, i) => {
        if (i === index) {
          item.classList.add('active');
        } else {
          item.classList.remove('active');
        }
      });
    }
    
    // Función de inicio de sesión
    function login(username, password) {
      const admin = JSON.parse(localStorage.getItem('renard_admin') || '{}');
      
      if (username === admin.username && password === admin.password) {
        document.getElementById('login-section').style.display = 'none';
        document.getElementById('dashboard-section').style.display = 'flex';
        localStorage.setItem('renard_logged_in', 'true');
        return true;
      }
      
      return false;
    }
    
    // Función de cierre de sesión
    function logout() {
      document.getElementById('login-section').style.display = 'flex';
      document.getElementById('dashboard-section').style.display = 'none';
      localStorage.removeItem('renard_logged_in');
    }
    
    // Al cargar la página
    document.addEventListener('DOMContentLoaded', function() {
        // Iniciar la "base de datos"
        initDatabase();

        // Inicializar el modal de eliminación
        deleteModal = new bootstrap.Modal(document.getElementById('deleteModal'));

        // Comprobar si hay una sesión iniciada
        if (localStorage.getItem('renard_logged_in') === 'true') {
            document.getElementById('login-section').style.display = 'none';
            document.getElementById('dashboard-section').style.display = 'flex';
            showProductsSection();
        }

        // Manejar el formulario de inicio de sesión
        document.getElementById('login-form').addEventListener('submit', function(e) {
            e.preventDefault();
            const username = document.getElementById('username').value;
            const password = document.getElementById('password').value;

            if (login(username, password)) {
                showProductsSection();
            } else {
                document.getElementById('login-error').style.display = 'block';
            }
        });

        // Manejar el formulario de producto
        document.getElementById('product-form').addEventListener('submit', function(e) {
            e.preventDefault();

            // Recopilar datos del formulario
            const productName = document.getElementById('product-name').value;
            const productDescription = document.getElementById('product-description').value;
            const productPrice = parseInt(document.getElementById('product-price').value);
            const productCategory = document.getElementById('product-category').value;
            const productAvailable = document.getElementById('product-available').checked;
            const productImageUrl = document.getElementById('product-image-url').value;
            const productImageFile = document.getElementById('product-image').files[0];

            // Determinar la URL de la imagen (priorizar archivo sobre URL)
            let imageUrl = productImageUrl;
            if (productImageFile) {
                const reader = new FileReader();
                reader.onload = function(event) {
                    imageUrl = event.target.result;

                    // Guardar o actualizar el producto
                    saveOrUpdateProduct(productName, productDescription, productPrice, productCategory, productAvailable, imageUrl);
                };
                reader.readAsDataURL(productImageFile);
            } else {
                // Guardar o actualizar el producto directamente si no hay archivo
                saveOrUpdateProduct(productName, productDescription, productPrice, productCategory, productAvailable, imageUrl);
            }
        });

        function saveOrUpdateProduct(name, description, price, category, available, imageUrl) {
            if (currentProductId) {
                // Actualizar producto existente
                const product = productsData.find(p => p.id === currentProductId);
                if (product) {
                    product.name = name;
                    product.description = description;
                    product.price = price;
                    product.category = category;
                    product.available = available;
                    product.imageUrl = imageUrl;
                }
            } else {
                // Añadir nuevo producto
                const newProduct = {
                    id: Date.now(),
                    name,
                    description,
                    price,
                    category,
                    available,
                    imageUrl
                };
                productsData.push(newProduct);
            }

            // Guardar cambios y volver a la lista de productos
            saveProducts();
            showProductsSection();
        }
    });
      // Iniciar la "base de datos"
      initDatabase();
      
      // Inicializar el modal de eliminación
      deleteModal = new bootstrap.Modal(document.getElementById('deleteModal'));
      
      // Comprobar si hay una sesión iniciada
      if (localStorage.getItem('renard_logged_in') === 'true') {
        document.getElementById('login-section').style.display = 'none';
        document.getElementById('dashboard-section').style.display = 'flex';
        showProductsSection();
      }
      
      // Manejar el formulario de inicio de sesión
      document.getElementById('login-form').addEventListener('submit', function(e) {
        e.preventDefault();
        const username = document.getElementById('username').value;
        const password = document.getElementById('password').value;
        
        if (login(username, password)) {
          showProductsSection();
        } else {
          document.getElementById('login-error').style.display = 'block';
        }
      });
      
      // Manejar el formulario de producto
      document.getElementById('product-form').addEventListener('submit', function(e) {
        e.preventDefault();

        // Recopilar datos del formulario
        const productName = document.getElementById('product-name').value;
        const productDescription = document.getElementById('product-description').value;
        const productPrice = parseInt(document.getElementById('product-price').value);
        const productCategory = document.getElementById('product-category').value;
        const productAvailable = document.getElementById('product-available').checked;
        const productImageUrl = document.getElementById('product-image-url').value;
        const productImageFile = document.getElementById('product-image').files[0];

        // Determinar la URL de la imagen (priorizar archivo sobre URL)
        let imageUrl = productImageUrl;
        if (productImageFile) {
          const reader = new FileReader();
          reader.onload = function(event) {
            imageUrl = event.target.result;

            // Guardar o actualizar el producto
            saveOrUpdateProduct(productName, productDescription, productPrice, productCategory, productAvailable, imageUrl);
          };
          reader.readAsDataURL(productImageFile);
        } else {
          // Guardar o actualizar el producto directamente si no hay archivo
          saveOrUpdateProduct(productName, productDescription, productPrice, productCategory, productAvailable, imageUrl);
        }
      });

      function saveOrUpdateProduct(name, description, price, category, available, imageUrl) {
        if (currentProductId) {
          // Actualizar producto existente
          const product = productsData.find(p => p.id === currentProductId);
          if (product) {
            product.name = name;
            product.description = description;
            product.price = price;
            product.category = category;
            product.available = available;
            product.imageUrl = imageUrl;
          }
        } else {
          // Añadir nuevo producto
          const newProduct = {
            id: Date.now(),
            name,
            description,
            price,
            category,
            available,
            imageUrl
          };
          productsData.push(newProduct);
        }

        // Guardar cambios y volver a la lista de productos
        saveProducts();
        showProductsSection();
      }
        e.preventDefault();
        
        // Recopilar datos del formulario
        const productName = document.getElementById('product-name').value;
        const productDescription = document.getElementById('product-description').value;
        const productPrice = parseInt(document.getElementById('product-price').value);
        const productCategory = document.getElementById('product-category').value;
        const productAvailable = document.getElementById('product-available').checked;
        const productImageUrl = document.getElementById('product-image-url').value;
        const productImageFile = document.getElementById('product-image').files